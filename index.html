
<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  
  <title>Study notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Study notes">
<meta property="og:url" content="http://sunyinge.github.io/index.html">
<meta property="og:site_name" content="Study notes">
<meta property="article:author" content="Yinge Sun">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Study notes" type="application/atom+xml">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <nav id="upper-nav" class="inner">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <div class="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        
          <a id="nav-github" class="nav-icon" href="https://github.com/sunyinge" target="_blank" rel="noopener"></a>
        
      </div>
    </nav>
    <div id="header-title">
      
        <h1 id="blog-title-wrap">
          <a href="/" id="blog-title">Study notes</a>
        </h1>
      
    </div>
    <div id="contenedor">
      <ul class="cube">
        <li class="cara">Hello!</li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
      </ul>
    </div>
    <nav id="main-nav">
      
        <a class="main-nav-link" href="/">Home</a>
      
        <a class="main-nav-link" href="/archives">Archives</a>
      
      <a class="main-nav-link st-search-show-outputs">Search</a>
    </nav>
  </div>
</header>

    <div class="outer">
      <section id="main">
  
    <article id="post-All-pairs-shortest-paths" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/07/12/All-pairs-shortest-paths/" class="article-date">
  <time datetime="2020-07-13T03:11:05.000Z" itemprop="datePublished">2020-07-12</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/12/All-pairs-shortest-paths/">All-pairs shortest paths</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <h3 id="matrix-multiplication-idea">1. Matrix Multiplication Idea</h3>
<p>Negative edges my be present but we assume there are <strong>no negative-weight cycles</strong>.</p>
<ul>
<li><strong>Idea</strong>: consider a shortest path <span class="math inline">\(p\)</span> from vertex <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> and suppose that <span class="math inline">\(p\)</span> contains at most <span class="math inline">\(m\)</span> edges (因为无negative-weight cycle所以<span class="math inline">\(m\)</span>有限). If <span class="math inline">\(i=j\)</span>, <span class="math inline">\(p\)</span> has weight 0; otherwise we decompose path <span class="math inline">\(p\)</span> into <span class="math inline">\(i\overset{p&#39;}{\leadsto}k\rightarrow j\)</span>, where <span class="math inline">\(p&#39;\)</span> contains at most <span class="math inline">\(m-1\)</span> edges, so <span class="math inline">\(\delta(i,j)=\delta(i,k)+w_{kj}\)</span>.</li>
</ul>
<p>A recursive solution to the all-pairs shortest-paths problem</p>
<p>Let <span class="math inline">\(l_{ij}^{(m)}\)</span> be the minimum weight of any path from vertex <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> that contains <strong>at most</strong> <span class="math inline">\(m\)</span> edges. Thus, <span class="math display">\[
l_{ij}^{(0)}=\bigg\{
\begin{align*}
&amp;0&amp;&amp; \text{if }i=j,\\
&amp;\infty&amp;&amp;\text{if }i\neq j.
\end{align*}
\]</span> For <span class="math inline">\(m\geq 1\)</span>, <span class="math display">\[
\begin{align*}
l_{ij}^{(m)}&amp;=&amp;&amp;\text{min}(l_{ij}^{(m-1)}, \underset{1\leq k \leq n, k\neq j}{\text{min}}\{l_{ij}^{(m-1)}+w_{kj}\})\\
&amp;=&amp;&amp;\underset{1\leq k \leq n}{\text{min}}\{l_{ij}^{(m-1)}+w_{kj}\}.
\end{align*}
\]</span> Since the shortest path from vertex <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> contain at most <span class="math inline">\(n-1\)</span> edges, <span class="math inline">\(\delta(i,j)=l_{ij}^{(n-1)}=l_{ij}^{(n)}=l_{ij}^{n+1}=\cdots\)</span>. So <span class="math inline">\(L^{n-1}\)</span> is what we want.</p>
<p>The following code extends the shortest path computed so far by one more edge (from <span class="math inline">\(L^{(m-1)}\)</span> to <span class="math inline">\(L^{(m)}\)</span>).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">EXTEND-SHORTEST-PATHS(L,W)</span><br><span class="line">1	n = L.rows</span><br><span class="line">2	<span class="built_in">let</span> L<span class="string">' = (l'</span>_ij) be a new n*n matrix</span><br><span class="line">3	<span class="keyword">for</span> i = 1 to n</span><br><span class="line">4		<span class="keyword">for</span> j = 1 to n</span><br><span class="line">5			l<span class="string">'_ij = inf</span></span><br><span class="line"><span class="string">6			for k = 1 to n</span></span><br><span class="line"><span class="string">7				l'</span>_ij = min(l<span class="string">'_ij,l_ik+w_kj)</span></span><br><span class="line"><span class="string">8	return L'</span></span><br></pre></td></tr></table></figure>
<p>And the following procedure computes <span class="math inline">\(L^{n-1}\)</span>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SLOW-ALL-PAIRS-SHORTEST-PATHS(W)</span><br><span class="line">1	n = W.rows</span><br><span class="line">2	L^(1) = W</span><br><span class="line">3	<span class="keyword">for</span> m = 2 to n-1</span><br><span class="line">4		<span class="built_in">let</span> L^(m) be a new n*n matrix</span><br><span class="line">5		L^(m) = EXTEND-SHORTEST-PATHS(L^(m-1),W)</span><br><span class="line">6	<span class="built_in">return</span> L^(n-1)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Remark</p>
<ul>
<li><p>EXTEND-SHORTEST-PATHS runs in <span class="math inline">\(\Theta(V^3)\)</span> so total <strong>running time</strong> for calculating all-pairs shortest paths is <span class="math inline">\(\Theta(V^4)\)</span>.</p></li>
<li><p>Since the EXTEND-SHORTEST-PATHS(L,W) procedure is similar as SQUARE-MATRIX-MULTIPLY(A,B), i.e., <span class="math inline">\(L^{(1)} = L^{(0)} \otimes W = W,\\ L^{(2)} = L^{(1)} \otimes W = W^{2\otimes},\\ L^{(3)} = L^{(2)} \otimes W = W^{3\otimes},\\ \cdots,\\ L^{(n-1)} = L^{(n-2)} \otimes W = W^{n-1\otimes}\)</span></p>
<p>,the procedure defined by the EXTEND-SHORTEST-PATHS is also <strong>associative</strong>. So <span class="math inline">\(L^{(1)} = W, L^{(2)} = W^{2\otimes} = W\otimes W,\\ L^{(4)} = W^{4\otimes}=W^{2\otimes}\otimes W^{2\otimes},\\ L^{(8)} = W^{8\otimes}=W^{4\otimes}\otimes W^{4\otimes},\\ \cdots,\\ L^{(2^{\lceil lg(n-1)\rceil})} = W^{2^{\lceil lg(n-1)\rceil}\otimes} = W^{2^{\lceil lg(n-1)\rceil -1}\otimes}\otimes W^{2^{\lceil lg(n-1)\rceil -1}\otimes}\)</span>.</p>
<p>So there is a faster implementation of finding all-pairs shortest-paths:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FASTER-ALL-PAIRS-SHORTEST-PATHS(W)</span><br><span class="line">1	n = W.rows</span><br><span class="line">2	L^(1) = W</span><br><span class="line">3	m = 1</span><br><span class="line">4	<span class="keyword">while</span> m &lt; n-1</span><br><span class="line">5		<span class="built_in">let</span> L^(2m) be a new n*n matrix</span><br><span class="line">6		L^(2m) = EXTEND-SHORTEST-PATHS(L^(m),L^(m))</span><br><span class="line">7		m = 2m</span><br><span class="line">8	<span class="built_in">return</span> L^(m)</span><br></pre></td></tr></table></figure>
<p>And it improves the <strong>running time</strong> to <span class="math inline">\(O(V^3lgV)\)</span>.</p></li>
</ul></li>
</ul>
<h3 id="the-floyd-warshall-algorithm">2. The Floyd-Warshall Algorithm</h3>
<p>Same as in section 1, negative edges my be present but we assume there are <strong>no negative-weight cycles</strong>.</p>
<p><strong>Intermediate</strong> vertex of a simple path <span class="math inline">\(p\)</span> is any vertex of <span class="math inline">\(p\)</span> other than the head and the end of <span class="math inline">\(p\)</span>.</p>
<ul>
<li><p><strong>Idea</strong>: (<span class="math inline">\(V=\{1,2,\ldots,n\}\)</span>) let <span class="math inline">\(p\)</span> be a minimum-weight path from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> whose intermediate vertices are all drawn from <span class="math inline">\(\{1,2,\ldots,k\}\)</span>. Consider the relationship between <span class="math inline">\(p\)</span> and shortest paths from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> with all intermediate vertices in the set <span class="math inline">\(\{1,2,\ldots,k-1\}\)</span>. If k is not an intermediate vertex of path <span class="math inline">\(p\)</span>, then all intermediate vertices of path <span class="math inline">\(p\)</span> are in the set <span class="math inline">\(\{1,2,\ldots,k-1\}\)</span>. If k is an intermediate vertex of path <span class="math inline">\(p\)</span>, then we decompose <span class="math inline">\(p\)</span> into <span class="math inline">\(i\overset{p_1}{\leadsto}k\overset{p_2}{\leadsto}j\)</span>, where <span class="math inline">\(p_1\)</span> is a shortest path from <span class="math inline">\(i\)</span> to <span class="math inline">\(k\)</span> with all intermediate vertices in the set <span class="math inline">\(\{1,2,\ldots,k-1\}\)</span> and <span class="math inline">\(p_2\)</span> is a shortest path from <span class="math inline">\(k\)</span> to <span class="math inline">\(j\)</span> with all intermediate vertices in the set <span class="math inline">\(\{1,2,\ldots,k-1\}\)</span>.</p>
<p><img src="/images/IntermediateVertex.png" /></p></li>
</ul>
<p>Let <span class="math inline">\(d_{ij}^{(k)}\)</span> be the weight of a shortest path from vertex <span class="math inline">\(i\)</span> to vertex <span class="math inline">\(j\)</span> for which all intermediate vertices are in the set <span class="math inline">\(\{1,2,\ldots,k\}\)</span>. Then, <span class="math display">\[
d_{ij}^{(k)}=\bigg\{
\begin{align*}
&amp;w_{ij} &amp;&amp; \text{if }k=0,\\
&amp;\text{min}(d_{ij}^{(k-1)},d_{ik}^{(k-1)}+d_{kj}^{(k-1)})&amp;&amp;\text{if }k\geq 1.
\end{align*}
\]</span> And <span class="math inline">\(D^{(n)}=(d_{ij}^{(n)})\)</span> gives the final answer: <span class="math inline">\(d_{ij}^{(n)}=\delta(i,j)\)</span> for all <span class="math inline">\(i,j\in V\)</span>.</p>
<p>And the dynamic programming and recursive solution to the all-pairs shortest-paths problem is</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FLOYD-WARSHALL(W)</span><br><span class="line">1	n = W.rows</span><br><span class="line">2	D^(0) = W</span><br><span class="line">3	<span class="keyword">for</span> k = 1 to n </span><br><span class="line">4		<span class="built_in">let</span> D^(k) = (d_ij^(k)) be a new n*n matrix</span><br><span class="line">5		<span class="keyword">for</span> i = 1 to n</span><br><span class="line">6			<span class="keyword">for</span> j = 1 to n</span><br><span class="line">7				d_ij^(k) = min(d_ij^(k-1),d_ik^(k-1)+d_kj^(k-1))</span><br><span class="line">8	<span class="built_in">return</span> D^(n)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Remark</p>
<ul>
<li>It's easy to see that the Floyd-Warshall runs in <span class="math inline">\(\Theta(V^3)\)</span> time.</li>
<li><strong>Transitive closure</strong> of G as the graph <span class="math inline">\(G^*=(V,E^*)\)</span>, where <span class="math inline">\(E^*=\{(i,j):\text{ there is a path form vertex }i\text{ to vertex }j \text{ in }G\}\)</span>. 有和Floyd-Warshall algorithm同样asymptotical computation time但快constant factor的算法算transitive closure.</li>
</ul></li>
<li><p>Constructing a shortest path</p>
<ul>
<li><p>Construct the predecessor matrxi <span class="math inline">\(\Pi\)</span> from <span class="math inline">\(D^{(n)}\)</span>. Each row of <span class="math inline">\(\Pi\)</span> is the predecessor matrix of a vertex <span class="math inline">\(i\)</span> and the predecessor subgraph induced by the row of <span class="math inline">\(\Pi\)</span> is the shortest-paths tree rooted at vertex <span class="math inline">\(i\)</span>. <span class="math inline">\(d_{ij}^{(n)}=d_{ik}{(n)}+w_{kj}\)</span>的<span class="math inline">\(k\)</span>(且<span class="math inline">\(k\neq j\)</span>)为<span class="math inline">\(j\)</span>的predecessor of path from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>.</p></li>
<li><p>Compute a sequence of predeceessor matrices $<sup>{(0)},</sup>{(1)},,^{(n)} $ while the Floyd-Warshall algorithm computes the matrices <span class="math inline">\(D^{(k)}\)</span>. <span class="math display">\[
\pi_{ij}^{(0)}=\bigg\{
\begin{align*}
&amp;NIL&amp;&amp;\text{if }i=j\text{ or }w_{ij}=\infty\\
&amp;i&amp;&amp;\text{if }i\neq j\text{ and }w_{ij}&lt;\infty
\end{align*}
\]</span></p>
<p><span class="math display">\[
\pi_{ij}^{(k)}=\bigg\{
\begin{align*}
&amp;\pi_{ij}^{(k-1)}&amp;&amp;\text{if }d_{ij}^{(k-1)}\leq d_{ik}^{(k-1)}+d_{kj}^{(k-1)},\\
&amp;\pi_{kj}^{(k-1)}&amp;&amp;\text{if }d_{ij}^{(k-1)}&gt;d_{ik}^{(k-1)}+d_{kj}^{(k-1)}.
\end{align*}
\]</span></p></li>
</ul></li>
</ul>
<h3 id="johnsons-algorithm-for-sparse-graphs">3. Johnson's Algorithm for Sparse Graphs</h3>
<p>Johnson's Algorithm returns a matrix shortest-path weights for all pairs of vertices or reports that the input contains a negative-weight cycle, using both Bellman-Ford algorithm and Dijkstra's algorithm as subroutines.</p>
<ul>
<li><p><strong>Idea</strong>: <strong>reweight </strong>(runs in $ O(VE)$ time). new weight需满足<strong>nonnegative</strong>以至于可以用Dijkstra's algorithm; <span class="math inline">\(p\)</span> is a shortest path from <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> using old weight <strong>if and only if</strong> <span class="math inline">\(p\)</span> is also a shortest path from <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> using new weight.</p>
<p>Make a new graph <span class="math inline">\(G&#39;=(V&#39;,E&#39;)\)</span>, where <span class="math inline">\(V&#39;=V\cup \{s\}\)</span> for some new vertex <span class="math inline">\(s\notin V\)</span> and <span class="math inline">\(E&#39;=E\cup\{(s,v):v\in V\}\)</span>. And <span class="math inline">\(w(s,v)=0\)</span> for all <span class="math inline">\(v\in V\)</span>. Moreover, <span class="math inline">\(G&#39;\)</span> has no negative-weight cycles if and only if <span class="math inline">\(G\)</span> has no negative-weight cycles. Let <span class="math inline">\(p=&lt;v_0,v_1,\ldots,v_k&gt;\)</span>, define new weight as <span class="math display">\[
\hat{w}(p)=w(p)+\delta(s,v_0)-\delta(s,v_k)
\]</span></p></li>
</ul>
<p>Then,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">JOHNSON(G,w)</span><br><span class="line">1	compute G<span class="string">', where G'</span>.V = G.V union &#123;s&#125;</span><br><span class="line">		G<span class="string">'.E = G.E union &#123;(s,v): v in G.V&#125;, and</span></span><br><span class="line"><span class="string">		w(s,v) = 0 for all v in G.V</span></span><br><span class="line"><span class="string">2	if BELLMAN-FORD(G'</span>,w,s) == FALSE</span><br><span class="line">3		<span class="built_in">print</span> <span class="string">"the input graph contains a negative-weight cycle"</span></span><br><span class="line">4	<span class="keyword">else</span> <span class="keyword">for</span> each vertex v <span class="keyword">in</span> G<span class="string">'.V</span></span><br><span class="line"><span class="string">5		for each edge (u,v) in G'</span>.E</span><br><span class="line">6			what(u,v) = w(u,v) + delta(s,u) - delta(s,v) <span class="comment"># delta from Bellman-Ford</span></span><br><span class="line">7		<span class="built_in">let</span> D = (d_uv) be a new n*n matrix</span><br><span class="line">8		<span class="keyword">for</span> each vertex u <span class="keyword">in</span> G.V</span><br><span class="line">9			run DIJKSTRA(G,what,u) to compute deltahat(u,v) <span class="keyword">for</span> all v <span class="keyword">in</span> G.V</span><br><span class="line">10			<span class="keyword">for</span> each vertex v <span class="keyword">in</span> G.V</span><br><span class="line">11				d_uv = deltahat(u,v) + delta(s,v) - delta(s,u)</span><br><span class="line">12		<span class="built_in">return</span> D</span><br></pre></td></tr></table></figure>
<p><img src="/images/Johnson.png" /></p>
<ul>
<li>Remark
<ul>
<li>Computation time: <span class="math inline">\(O(V^2lgV+VE)\)</span> if min-priority queue in Dijkstra's algorithm impletemented by Fibonacci heap and <span class="math inline">\(O(VElgV)\)</span> if by binary-heap.</li>
</ul></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/07/12/All-pairs-shortest-paths/" data-id="ckck2dmd1000lgr3xb6324xou" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Single-source-shortest-path" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/07/11/Single-source-shortest-path/" class="article-date">
  <time datetime="2020-07-12T05:27:21.000Z" itemprop="datePublished">2020-07-11</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/11/Single-source-shortest-path/">Single-source shortest path</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="shortest-path-problem">1. <strong>Shortest-Path Problem</strong></h3>
<p>A weighted, directed graph <span class="math inline">\(G=(V,E)\)</span> with weight function <span class="math inline">\(w: E\rightarrow\mathbb{R}\)</span>.</p>
<p>The weight <span class="math inline">\(w(p)\)</span> of path <span class="math inline">\(p=&lt;v_0,v_1,\ldots,v_k&gt;\)</span> is <span class="math inline">\(w(p)=\sum_{i=1}^kw(v_{i-1},v_i)\)</span> and the <strong>shortest-paht weight</strong> <span class="math inline">\(\delta(u,v)\)</span>from <span class="math inline">\(u\)</span> to <span class="math inline">\(v\)</span> is <span class="math display">\[
\delta(u,v)=\bigg\{
\begin{align*}
&amp;\text{min}\{w(p):u\overset{p}{\leadsto}v\} &amp;&amp; \text{if there is a path from $u$ to $v$,}\\
&amp;\infty &amp;&amp; \text{otherwise.}
\end{align*}
\]</span> A <strong>shortest path</strong> from vertex <span class="math inline">\(u\)</span> to vertex <span class="math inline">\(v\)</span> is then defined as any path <span class="math inline">\(p\)</span> with weight <span class="math inline">\(w(p)=\delta(u,v)\)</span>.</p>
<p><strong>Single-source shortest-paths problem</strong>: given a graph <span class="math inline">\(G=(V,E)\)</span>, we want to find a shortest path from a given <strong>source</strong> vertex <span class="math inline">\(s\in V\)</span> to each vertex <span class="math inline">\(v\in V\)</span>.</p>
<ul>
<li>Lemma: <strong>subpaths of shortest paths are shortest paths</strong></li>
</ul>
<p>A <strong>shortest-paths tree</strong> rooted at <span class="math inline">\(s\)</span> is a directed subgraph <span class="math inline">\(G&#39;=(V&#39;,E&#39;)\)</span>, where <span class="math inline">\(V&#39;\subseteq V\)</span> and <span class="math inline">\(E&#39;\subseteq E\)</span>, such that</p>
<ol type="1">
<li><span class="math inline">\(V&#39;\)</span> is the set of vertices reachable from <span class="math inline">\(s\)</span> in G</li>
<li><span class="math inline">\(G&#39;\)</span> forms a rooted tree with <span class="math inline">\(s\)</span>, and</li>
<li>for all <span class="math inline">\(v\in V&#39;\)</span>, the unique simple path from <span class="math inline">\(s\)</span> to <span class="math inline">\(v\)</span> in <span class="math inline">\(G&#39;\)</span> in a shortest path from <span class="math inline">\(s\)</span> to <span class="math inline">\(v\)</span> in <span class="math inline">\(G\)</span>.</li>
</ol>
<ul>
<li><strong>Remark</strong>
<ul>
<li>If the graph contains a negative-weight cycle reachable from the source <span class="math inline">\(s\)</span>, shortest-path weights are not well defined.</li>
<li>WLOG, we assume no cycles in shortest paths, i.e., shortest paths are simple paths.</li>
<li>Shortest paths are not necessarily unique and neither are shortest-paths tree.</li>
</ul></li>
</ul>
        
          <p class="article-more-link">
            <a href="/2020/07/11/Single-source-shortest-path/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/07/11/Single-source-shortest-path/" data-id="ckck2dmck0005gr3x2lrtc7gc" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Dynamic-programming" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/29/Dynamic-programming/" class="article-date">
  <time datetime="2020-06-30T05:15:15.000Z" itemprop="datePublished">2020-06-29</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/29/Dynamic-programming/">Dynamic programming</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="elements-of-dynamic-programming">1. Elements of Dynamic Programming</h3>
<p>When does the dynamic programming method apply?</p>
<ul>
<li>Two key ingredients that an optimization problems must have in order for dynamic programming to apply: <strong>optimal substructure</strong> and <strong>overlapping subproblems</strong>.</li>
</ul>
<h4 id="optimal-substructure">1. Optimal Substructure</h4>
<p>A problem exhibits <strong>optimal substruture</strong> if an optimal solution to the problem contains within it optimal solutions to subproblems. (Optimal solutions to a problem incorporate optimal solutions to related subproblems, which we may solve <strong>independently</strong>)</p>
<p>Optimal substructure varies across problem domains in two ways:</p>
<ol type="1">
<li><p><strong>how many subproblmes</strong> an optimal solution to the original problem uses</p></li>
<li><p><strong>how many choices</strong> we have in determining which subproblems to use in an optimal solution</p></li>
</ol>
<p>Actually, the <strong>running time</strong> of a dynamic programming algorithm depends on the product of the two factors above: the number of subproblems overall and how many choives we look at for each subproblem.</p>
<h4 id="overlapping-subproblems">2. Overlapping Subproblems</h4>
<p>We say that the optimazation problem has <strong>overlapping subproblems</strong> when a recursive algorithm <strong>revisits the same problem repeatedly</strong>.</p>
<p>In contrast, a problem for which a <strong>divide-and-conquer</strong> approach is suitable usually generated brand-new problems at each step of the recursion.</p>
        
          <p class="article-more-link">
            <a href="/2020/06/29/Dynamic-programming/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/29/Dynamic-programming/" data-id="ckck2dmc70000gr3x0kmjbqbe" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Python" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/24/Python/" class="article-date">
  <time datetime="2020-06-25T03:24:45.000Z" itemprop="datePublished">2020-06-24</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/24/Python/">Python</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <h3 id="nested-functions-in-object">1. Nested Functions in Object</h3>
<ul>
<li><p>Function with self can be referenced before its assignment. E.g.,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">function0</span><span class="params">(self,args)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> self.function1(args)</span><br><span class="line">    		</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">function1</span><span class="params">(self,args_1)</span>:</span></span><br><span class="line">		<span class="comment">###</span></span><br><span class="line">		self.function1(args_1)</span><br><span class="line">		<span class="keyword">return</span> <span class="comment">###</span></span><br></pre></td></tr></table></figure></li>
<li><p>Function without self cannot be referenced before its assignment. E.g.,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">function0</span><span class="params">(self,args)</span>:</span></span><br><span class="line">		<span class="function"><span class="keyword">def</span> <span class="title">function1</span><span class="params">(args_1)</span>:</span></span><br><span class="line">			<span class="comment">###</span></span><br><span class="line">			function1(args_1)</span><br><span class="line">			<span class="keyword">return</span> <span class="comment">###</span></span><br><span class="line">                      </span><br><span class="line">		<span class="keyword">return</span> function1(args)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="my-cheat-sheet">2. My Cheat Sheet</h3>
<ul>
<li><p><strong>Power</strong>: **</p></li>
<li><p><strong>Matrix multiplication</strong> in np: matmul, @, dot (2d matrix only)</p></li>
<li><p><strong>Element-wise multiplication</strong> in np: multiply</p></li>
<li><p>reversed(list[0:length]) = list[length-1<strong>::</strong>-1], reversed(list[1:length]) = list[length-1:<strong>0</strong>:-1]</p></li>
<li><p>The <code>strip()</code> method removes any leading (spaces at the beginning) and trailing (spaces at the end) characters (space is the default leading character to remove). The default character to be removed is whitespace.</p></li>
<li><p>The <code>ord()</code> function returns an integer representing the Unicode character. The <code>chr()</code> method returns a string representing a character whose Unicode code point is an integer.</p></li>
<li><p><code>break</code> statement <strong>only</strong> terminates the loop in which it appears.</p></li>
<li><p><code>map(func, iter)</code> returns a map object (an iterator) of the results after applying the given functions to each item of a given iterable, which can be passed to functions like <code>list()</code> (to create a list), <code>set()</code> to create a set. For example,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nums1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">nums2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">result = map(<span class="keyword">lambda</span> x, y: x+y, nums1, nums2)</span><br><span class="line">print(result)</span><br><span class="line"><span class="comment">### Output: </span></span><br><span class="line">[<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>Nested list comprehension: they would nest in the same way for loops and if statements nest (对于循环和if语句嵌套，它们将以相同的方式嵌套). For example,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">non_flat = [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], [<span class="number">7</span>,<span class="number">8</span>]]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Wrong</span></span><br><span class="line">[y <span class="keyword">for</span> y <span class="keyword">in</span> x <span class="keyword">for</span> x <span class="keyword">in</span> non_flat]</span><br><span class="line"><span class="comment">### Output:</span></span><br><span class="line">NameError: name <span class="string">'x'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Correct</span></span><br><span class="line">[y <span class="keyword">for</span> x <span class="keyword">in</span> non_flat <span class="keyword">for</span> y <span class="keyword">in</span> x]</span><br><span class="line"><span class="comment">### Output:</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Just like this:</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> non_flat:</span><br><span class="line">	<span class="keyword">for</span> y <span class="keyword">in</span> x:</span><br><span class="line">		y</span><br></pre></td></tr></table></figure></li>
<li><p>Sort a string will become a list of characters. To get the sorted string of the original string, use <code>&quot;&quot;.join(sorted(str))</code>.</p></li>
<li><p><code>dict.values()</code> will return a list of dictionary values, equivalent to <code>[dict[x] for x in dict]</code> or <code>[x for x in dict.values()]</code>.</p></li>
<li><p><code>l=[[&quot;.&quot;]*4]*3</code>. If change one value of <code>l</code>, e.g., <code>l[1][2] = 2</code>, then all values of <code>l[i][2]</code> will be 2 (for all i=0,1,2).</p></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/24/Python/" data-id="ckck2dmcw000ggr3x9nc9elc7" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Probabilistic-graphic-models-for-sequence-tagging" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/23/Probabilistic-graphic-models-for-sequence-tagging/" class="article-date">
  <time datetime="2020-06-24T04:12:45.000Z" itemprop="datePublished">2020-06-23</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/23/Probabilistic-graphic-models-for-sequence-tagging/">Probabilistic graphic models for sequence tagging</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Sequence tagging, such as <strong>part of speech (POS) tagging</strong> and <strong>named entity recognition (NER)</strong>.</p>
<p>Let <span class="math inline">\(\mathbf{x}=x_1,x_2,\ldots,x_T\)</span> be a sequence of words and <span class="math inline">\(\mathbf{y}=y_1,y_2,\ldots,y_T\)</span> be a sequence of their tags.</p>
<h3 id="generative-models">1. Generative Models</h3>
<p>A Generative Model ‌learns the <strong>joint probability distribution p(x,y).</strong> It predicts the conditional probability with the help of Bayes Theorem.</p>
<h4 id="hidden-markov-models-hmm">1. Hidden Markov Models (HMM)</h4>
<h5 id="the-model">1. The model</h5>
<p><span class="math display">\[
\mathbf{y}=\underset{y}{\text{argmax}}\  p(\mathbf{y}|\mathbf{x})=\underset{y}{\text{argmax}}\ p(\mathbf{x},\mathbf{y})
\]</span></p>
<ul>
<li><p>Markov assumption: <span class="math inline">\(p(\mathbf{y})=\prod_{t=1}^Tp(y_t|y_{t-1})\)</span></p></li>
<li><p>Independence assumption: <span class="math inline">\(p(\mathbf{x}|\mathbf{y})=\prod_{t=1}^Tp(x_t|y_{t})\)</span></p></li>
</ul>
<p>Then we have, <span class="math display">\[
p(\mathbf{x},\mathbf{y})=p(\mathbf{x}|\mathbf{y})p(\mathbf{y})=\prod_{t=1}^Tp(x_t|y_{t})p(y_t|y_{t-1}).
\]</span> A HMM is specified by</p>
        
          <p class="article-more-link">
            <a href="/2020/06/23/Probabilistic-graphic-models-for-sequence-tagging/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/23/Probabilistic-graphic-models-for-sequence-tagging/" data-id="ckck2dmci0003gr3xgw9obfbk" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-End-symbol-in-n-gram-models" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/09/End-symbol-in-n-gram-models/" class="article-date">
  <time datetime="2020-06-09T23:56:14.000Z" itemprop="datePublished">2020-06-09</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/09/End-symbol-in-n-gram-models/">What&#39;s the real need for an end-symbol in n-gram models?</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <hr />
<p><strong>We need the end-symbol to make the bigram grammar a true probability distribution. Without an end-symbol, the sentence probabilities for all sentences of a given length would sum to one, and the probability of the whole language would be infinite.</strong></p>
<p>That is, the probabilities of one-word sequences sum to one <span class="math inline">\(\sum_iP(w_i)=1\)</span>, the probabilities of two-word sequences sum to one <span class="math inline">\(\sum_i\sum_jP(w_iw_j)=1\)</span>, <span class="math inline">\(\ldots\)</span>, etc.</p>
<p>Without an end-symbol, there's no distinction between &quot;the probability of seeing two words next to each other&quot; and &quot;the probability of seeing a two-word sentence&quot;.</p>
<p>So we add an end-symbol to the <strong>bigram language model</strong> (n-gram language model: current word depends on previous n-1 words only) to assign <strong>a single probability distribution across all sentence lengths</strong>, which is <span class="math display">\[
P(\mathbf{w})=\prod_{i=1}^{k+1}P(w_i|w_{i-1})
\]</span> where <span class="math inline">\(w_0\)</span> is a start-symbol and <span class="math inline">\(w_{k+1}\)</span> is an end-symbol.</p>

      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/09/End-symbol-in-n-gram-models/" data-id="ckck2dmcd0001gr3x50o95eme" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Text-classification" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/08/Text-classification/" class="article-date">
  <time datetime="2020-06-09T00:32:21.000Z" itemprop="datePublished">2020-06-08</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/08/Text-classification/">Text classification</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="text-preprocessing">1. Text Preprocessing</h3>
<p>How to find the boundaries of words?</p>
<ul>
<li><p>Tokenization</p>
<ul>
<li>Spilt an input sequence into so-called tokens</li>
<li>Tokenizer: whitespace, punctuation, treebank (based on a set of rules or heuristics, close to perfect tokenization)</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="/images/whitespace.png" /></th>
<th style="text-align: center;"><img src="/images/punct.png" /></th>
<th style="text-align: center;"><img src="/images/treebank.png" /></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><em>Whitespace</em></td>
<td style="text-align: center;"><em>Punctuation</em></td>
<td style="text-align: center;"><em>Treebank</em></td>
</tr>
</tbody>
</table></li>
<li><p>Token normalization</p>
<ul>
<li>Stemming
<ul>
<li>Remove and replace suffixes to get to the root form of the word, which is called <strong>stem</strong></li>
<li>Example: Porter's stemmer
<ul>
<li>Problem: fails on irregular words (e.g., feet <span class="math inline">\(\rightarrow\)</span> feet), produces non-words (e.g., wolves <span class="math inline">\(\rightarrow\)</span> wolv )</li>
</ul></li>
</ul></li>
<li>Lemmatization -- dictionary form
<ul>
<li>Use a vocabulary and morphological analysis to get the base or dictionary form of the word, which is called <strong>lemma</strong></li>
<li>Example: WordNet lemmatizer
<ul>
<li>Problem: not all forms are reduced (e.g., talked <span class="math inline">\(\rightarrow\)</span> talked)</li>
</ul></li>
</ul></li>
</ul>
<p><strong>We need to try stemming or lemmatization and choose best for our task.</strong></p>
<ul>
<li>Further normalization
<ul>
<li>Normalizing capital letters</li>
<li>Acronyms</li>
</ul></li>
</ul></li>
</ul>
<h3 id="feature-extraction-from-text">2. Feature Extraction from Text</h3>
        
          <p class="article-more-link">
            <a href="/2020/06/08/Text-classification/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/08/Text-classification/" data-id="ckck2dmct000egr3xghzgddab" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Matrix-derivatives" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/08/Matrix-derivatives/" class="article-date">
  <time datetime="2020-06-08T20:57:50.000Z" itemprop="datePublished">2020-06-08</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/08/Matrix-derivatives/">Matrix derivatives</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <h3 id="scalar-by-matrix">1. Scalar by Matrix</h3>
<p>From the <a href="https://sunyinge.github.io/2020/06/08/MLP/">post</a>, we know if <span class="math inline">\(l\)</span> is a scalar and <span class="math inline">\(C=AB\)</span> where A, B, C are matrixes, we have <span class="math display">\[
\frac{\partial l}{\partial A} = \frac{\partial l}{\partial C}\cdot B^T\\
\frac{\partial l}{\partial B} = A^T\cdot\frac{\partial l}{\partial C}.
\]</span></p>
<h3 id="matrix-by-matrix">2. Matrix by Matrix</h3>
<p>If <span class="math inline">\(C=AB\)</span> where A, B, C are matrixes, we have <span class="math display">\[
\frac{\partial C}{\partial A} = \{\frac{\partial C_{ij}}{\partial A_{kl}}\}_{ijkl},
\]</span> which is a high-dimensional array, called <strong>tensor</strong>.</p>
<p>It is not quite useful in practice.</p>
<h3 id="jacobian">3. Jacobian</h3>
<p>Composition of two vector functions (useful in RNN): <span class="math display">\[
g(x):(x_1,\ldots,x_n)\rightarrow (g_1,\ldots,g_m)\\
f(g):(g_1,\ldots,g_m)\rightarrow (f_1,\ldots,f_l).
\]</span> Then <span class="math display">\[
h(x)=f(g(x)):(x_1,\ldots,x_n)\rightarrow (h_1,\ldots,h_l)=(f_1,\ldots,f_l).
\]</span> The matrix of partial derivatives <span class="math inline">\(\{\frac{\partial h_i}{\partial x_j}\}_{ij}\)</span> is called the <strong>Jacobian</strong>: <span class="math display">\[
J^h=
\left( 
\begin{array}{ccc}
    \frac{\partial h_1}{\partial x_1} &amp; \cdots &amp; \frac{\partial h_1}{\partial x_n}\\
    \vdots &amp; \ddots &amp; \vdots \\
     \frac{\partial h_l}{\partial x_1} &amp; \cdots &amp; \frac{\partial h_l}{\partial x_n}\\
\end{array} \right).
\]</span> The <strong>chain rule</strong> of Jacobian: <span class="math display">\[
J^h=J^f\cdot J^g.
\]</span></p>

      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Optimization/" rel="tag">Optimization</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/08/Matrix-derivatives/" data-id="ckck2dmcn0008gr3x4lc679yu" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-MLP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/08/MLP/" class="article-date">
  <time datetime="2020-06-08T17:16:30.000Z" itemprop="datePublished">2020-06-08</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/08/MLP/">MLP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="intuition">1. Intuition</h3>
<h4 id="linear-binary-classification">1. Linear binary classification</h4>
<p>Features: (<span class="math inline">\(x_1,x_2\)</span>)</p>
<p>Target: <span class="math inline">\(y\in \{1,-1\}\)</span></p>
<p>Decision function (distance to the boundary): <span class="math inline">\(d(x)=w_0+w_1x_1+w_2x_2\)</span></p>
<p>Algorithm: <span class="math inline">\(a(x)=sign(d(x))\)</span></p>
<h4 id="logistic-regression">2. Logistic regression</h4>
<p>Features: (<span class="math inline">\(x_1,x_2\)</span>)</p>
<p>Target: <span class="math inline">\(y\in \{0,1\}\)</span></p>
<p>Decision function: <span class="math inline">\(d(x)=w_0+w_1x_1+w_2x_2\)</span></p>
<p>Algorithm: <span class="math inline">\(a(x)=\sigma(d(x))\)</span>, where <span class="math inline">\(\sigma(x)=\frac{1}{1+e^{-x}}\)</span></p>
<h4 id="triangle-problem">3. Triangle problem</h4>
<p>Features: (<span class="math inline">\(x_1,x_2\)</span>)</p>
<p>Target: <span class="math inline">\(y\in \{0,1\}\)</span></p>
<p><img src="/images/triangle.png" style="zoom:40%;" /></p>
<p>A logistic regression per subproblem, and the three lines give us <strong>new features</strong> <span class="math inline">\((x_1,x_2)\rightarrow(z_1,z_2,z_3)\)</span>.</p>
<h3 id="multilayer-perceptron-mlp">2. Multilayer Perceptron (MLP)</h3>
<ul>
<li>Computation graph
<ul>
<li>Take a linear combination of inputs</li>
<li>Apply nonlinear activation function, e.g., <span class="math inline">\(\sigma(x)\)</span></li>
</ul></li>
</ul>
<p><img src="/images/compgraph.png" /></p>
<ul>
<li><p>Architecture of an MLP</p>
<ul>
<li>Number of layers</li>
<li>Number of neurons in each layer</li>
<li>Activation function</li>
</ul>
<p>A hidden layer in MLP is a dense layer or fully-connected layer.</p></li>
</ul>
        
          <p class="article-more-link">
            <a href="/2020/06/08/MLP/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/08/MLP/" data-id="ckck2dmcx000igr3x9tnc63zi" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
    <article id="post-Measure-of-accuracy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/06/07/Measure-of-accuracy/" class="article-date">
  <time datetime="2020-06-08T06:04:06.000Z" itemprop="datePublished">2020-06-07</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/07/Measure-of-accuracy/">Measure of accuracy</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="f1-score">1. F1 Score</h3>
<h4 id="binary-classification">1. Binary Classification</h4>
<p>F1 score is the harmonic mean of precision and recall: <span class="math display">\[
F_1 = \frac{2}{\frac{1}{precision}+\frac{1}{recall}}=2\cdot\frac{precision\cdot recall}{precesion+recall}
\]</span></p>
<ul>
<li><strong>Precision</strong> = <span class="math inline">\(\frac{true \ positives}{positives}\)</span>, a high precision indicates a high chance that positives are true (凡检测出来的都是对的).
<ul>
<li>How many selected items are true?</li>
</ul></li>
<li><strong>Recall</strong> = <span class="math inline">\(\frac{true \ positives}{true}\)</span>, a high recall indicates a high chance that true ones are selected (凡是真的都能检测出来).
<ul>
<li>How many true items are selected?</li>
<li><strong>True postive rate</strong>, <strong>sensitivity</strong>, <strong>power</strong>.</li>
</ul></li>
</ul>
<h4 id="multiclass-classification">2. Multiclass Classification</h4>
<p>Based on the confusion matrix (left), we can calculate the precision and recall for each class (right).</p>
<p><img src="/images/mcF1.png" /></p>
        
          <p class="article-more-link">
            <a href="/2020/06/07/Measure-of-accuracy/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ML/" rel="tag">ML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Optimization/" rel="tag">Optimization</a></li></ul>

        <a data-url="http://sunyinge.github.io/2020/06/07/Measure-of-accuracy/" data-id="ckck2dmcj0004gr3x37qscwyn" class="article-share-link">Share</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
</article>



  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
    </nav>
  
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/12/All-pairs-shortest-paths/">All-pairs shortest paths</a>
          </li>
        
          <li>
            <a href="/2020/07/11/Single-source-shortest-path/">Single-source shortest path</a>
          </li>
        
          <li>
            <a href="/2020/06/29/Dynamic-programming/">Dynamic programming</a>
          </li>
        
          <li>
            <a href="/2020/06/24/Python/">Python</a>
          </li>
        
          <li>
            <a href="/2020/06/23/Probabilistic-graphic-models-for-sequence-tagging/">Probabilistic graphic models for sequence tagging</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DL/" rel="tag">DL</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Installation/" rel="tag">Installation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ML/" rel="tag">ML</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/" rel="tag">NLP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Optimization/" rel="tag">Optimization</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Yinge Sun<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/sun11/hexo-theme-paperbox" target="_blank">Paperbox</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
  <a href="#search" class="mobile-nav-link st-search-show-outputs">Search</a>
</nav>

  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    menuSettings: {
      zoom: "None"
    },
    showMathMenu: false,
    jax: ["input/TeX","output/CommonHTML"],
    extensions: ["tex2jax.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js"],
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
  });
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script>



<!-- totop start -->
<div id="totop">
	<a title="To Top"></a>
</div>
<!-- totop end -->

<!-- swiftype search start -->

<!-- swiftype search end -->



<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/lrsjng.jquery-qrcode/0.12.0/jquery.qrcode.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


</div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
